SELECT 
    f.FLIGHTMONTH
    ,c.CARRIERDESCRIPTION
    ,COUNT(F.FACT_KEY) CNT
    ,RANK() OVER (PARTITION BY  f.FLIGHTMONTH ORDER BY COUNT(f.FACT_KEY) DESC) Rnk
FROM
    FACT_ONTIME f INNER JOIN
    DIM_CARRIER c ON (F.FK_CARRIER_KEY=C.CARRIERKEY AND F.FLIGHT_YEAR IN (1996))l
GROUP BY
    f.FLIGHTMONTH
    ,c.CARRIERDESCRIPTION
ORDER BY 
    f.FLIGHTMONTH, Rnk    
